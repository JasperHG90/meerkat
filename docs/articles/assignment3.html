<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assignment 3 • meerkat</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Assignment 3">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">meerkat</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/assignment2.html">Assignment 2</a>
    </li>
    <li>
      <a href="../articles/assignment3.html">Assignment 3</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JasperHG90/meerkat.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Assignment 3</h1>
                        <h4 class="author">Jasper Ginn</h4>
            
            <h4 class="date">2018-12-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JasperHG90/meerkat.git/blob/master/vignettes/assignment3.Rmd"><code>vignettes/assignment3.Rmd</code></a></small>
      <div class="hidden name"><code>assignment3.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The code in this package is stored in the ‘meerkat’ package. It contains helper functions that are not exported and for which no visible documentation was written. At the start of each part, I give a link to the R-code hosted on GitHub where you can view the code.</p>
</div>
<div id="part-i" class="section level2">
<h2 class="hasAnchor">
<a href="#part-i" class="anchor"></a>PART I</h2>
<p>View the code belonging to this assignment <a href="https://github.com/JasperHG90/meerkat/blob/master/R/a3_power.R">here</a></p>
<p><em>1. Assuming that the data are approximately normal, simulate one sample of data and perform a t-test using the R in-built t-test function. What is the p-value of the test? What is your conclusion?.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="kw">library</span>(meerkat)

<span class="co"># Set values and draw a sample</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mu &lt;-<span class="st"> </span><span class="dv">160</span>
mu0 &lt;-<span class="st"> </span><span class="dv">150</span>
sd &lt;-<span class="st"> </span><span class="dv">15</span>
<span class="kw">set.seed</span>(<span class="dv">600</span>)
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, mu, sd)
<span class="kw">set.seed</span>(<span class="dv">500</span>)
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, mu0, sd)
<span class="co"># We perform a t-test on the data</span>
<span class="kw">t.test</span>(x, y, <span class="dt">alternative=</span><span class="st">"greater"</span>, <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  x and y
## t = 3.7003, df = 98, p-value = 0.0001778
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  6.154347      Inf
## sample estimates:
## mean of x mean of y 
##  160.6356  149.4711</code></pre>
<p>The one-tailed test is statistically significant (p&lt;0.001). At a significance level of a=0.05 we would therefore reject the null that there is no difference in the test scores of these groups. The experimental group , it would seem, performed better than the control and the special training has had the desired effect.</p>
<p><strong>2. Assume that the data are normally distributed, write a function that generates data and performs a t-test 1000 times and that stores the values of the t-statistic (or the p-value) in a vector. Thinking about the definition of power in terms of rejecting the null hypothesis, how would you obtain an estimate of the power in this situation? Compare your results with those given by power.t.test</strong></p>
<p><em>Power</em> is defined as the probability <span class="math inline">\(\pi(\theta)\)</span> of rejecting the null hypothesis given that the alternative hypothesis is true.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. The probability of making a Type II error (wrongfully concluding that there is no effect while an effect exists) is <span class="math inline">\(1-\pi(\theta))\)</span>. A common maximum value for the Type II error is that we should not commit it in more than 20% of cases. Hence, the ‘minimum’ power we should strive for is <span class="math inline">\(0.8\)</span>, meaning that we can detect effects <span class="math inline">\(4\)</span> out of <span class="math inline">\(5\)</span> times.</p>
<p>The function <code><a href="../reference/emp_power.html">emp_power()</a></code> calculates, for a given <span class="math inline">\(R\)</span> number of repititions, the t-statistic between the mean value of the control group and that of a random sample drawn from the normal distribution. Given that we are interested in the probability <span class="math inline">\(\pi(\theta)\)</span>, a reasonable approach is to take the proportion of cases where the null hypothesis is rejected. In this case, if the true difference of means is <span class="math inline">\(0\)</span>, we would still expect to achieve a power of 5% because of the Type I error rate. As we increase the difference in mean values, we expect the power (or the percentage of significant t-tests) to increase.</p>
<p>Furthermore, given that we draw data from a normal distribution and for values where <span class="math inline">\(\theta_0 &lt; \theta_1\)</span>, we may be confident that the power of our test increases as we:</p>
<ol style="list-style-type: decimal">
<li>increase the sample size</li>
<li>increase the significance level <span class="math inline">\(\alpha\)</span> (e.g. from <span class="math inline">\(0.05\)</span> to <span class="math inline">\(0.1\)</span>)</li>
<li>decrease the standard deviation in the sample</li>
</ol>
<p>The effect of changing these values is shown in the plots below</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(grid)
<span class="kw">library</span>(gridExtra)
<span class="co"># Define a grid of possible mean values from 140 to 160</span>
grids &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">grid_mu =</span> <span class="kw">seq</span>(<span class="dv">140</span>, <span class="dv">160</span>, <span class="dv">1</span>),
  <span class="dt">grid_sd =</span> <span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="fl">0.5</span>),
  <span class="dt">grid_alpha =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.11</span>, <span class="fl">0.005</span>),
  <span class="dt">grid_n =</span> <span class="kw">seq</span>(<span class="dv">50</span>, <span class="dv">150</span>, <span class="dv">5</span>)
)

grids_out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>, <span class="dt">length =</span> <span class="dv">4</span>)
<span class="co"># For each value, calculate the power of the t-test while holding the other parameters constant</span>
<span class="cf">for</span>( i <span class="cf">in</span> <span class="kw">seq_along</span>(grids) ) {
  
  <span class="co"># Get name</span>
  grids_in_name &lt;-<span class="st"> </span><span class="kw">names</span>(grids)[i]
  grid &lt;-<span class="st"> </span>grids[[i]]
  
  <span class="co"># This switch is a wrapper for a bunch of if/else statements</span>
  power_values &lt;-<span class="st"> </span><span class="cf">switch</span>(grids_in_name,
                          <span class="dt">grid_mu =</span> <span class="kw">lapply</span>(grid, <span class="cf">function</span>(x) <span class="kw"><a href="../reference/emp_power.html">emp_power</a></span>(<span class="dv">50</span>, 
                                                                       x, 
                                                                       <span class="dv">15</span>, 
                                                                       <span class="dt">R=</span><span class="dv">1000</span>, 
                                                                       <span class="dt">type=</span><span class="st">"two_sample"</span>,
                                                                       <span class="dt">alpha=</span><span class="fl">0.05</span>, 
                                                                       <span class="dt">alternative=</span><span class="st">"greater"</span>, 
                                                                       <span class="dt">mu0=</span><span class="dv">150</span>)),
                          <span class="dt">grid_n =</span> <span class="kw">lapply</span>(grid, <span class="cf">function</span>(x) <span class="kw"><a href="../reference/emp_power.html">emp_power</a></span>(x, <span class="dv">155</span>, <span class="dv">15</span>, <span class="dt">R=</span><span class="dv">1000</span>, 
                                                                      <span class="dt">type=</span><span class="st">"two_sample"</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>, 
                                                                      <span class="dt">alternative=</span><span class="st">"greater"</span>, <span class="dt">mu0=</span><span class="dv">150</span>)),
                          <span class="dt">grid_sd =</span> <span class="kw">lapply</span>(grid, <span class="cf">function</span>(x) <span class="kw"><a href="../reference/emp_power.html">emp_power</a></span>(<span class="dv">50</span>, <span class="dv">155</span>, x, <span class="dt">R=</span><span class="dv">1000</span>, 
                                                                       <span class="dt">type=</span><span class="st">"two_sample"</span>,<span class="dt">alpha=</span><span class="fl">0.05</span>, 
                                                                       <span class="dt">alternative=</span><span class="st">"greater"</span>, <span class="dt">mu0=</span><span class="dv">150</span>)),
                          <span class="dt">grid_alpha =</span> <span class="kw">lapply</span>(grid, <span class="cf">function</span>(x) <span class="kw"><a href="../reference/emp_power.html">emp_power</a></span>(<span class="dv">50</span>, <span class="dv">155</span>, <span class="dv">15</span>, <span class="dt">R=</span><span class="dv">1000</span>, 
                                                                          <span class="dt">type=</span><span class="st">"two_sample"</span>,<span class="dt">alpha=</span>x, 
                                                                          <span class="dt">alternative=</span><span class="st">"greater"</span>, <span class="dt">mu0=</span><span class="dv">150</span>))
  )
  
  <span class="co"># Get values</span>
  pv &lt;-<span class="st"> </span><span class="kw">sapply</span>(power_values, <span class="cf">function</span>(x) x<span class="op">$</span>power)
  
  <span class="co"># In data frame</span>
  df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">"grid"</span> =<span class="st"> </span>grid,
                   <span class="st">"power"</span> =<span class="st"> </span>pv,
                   <span class="st">"se"</span> =<span class="st"> </span><span class="kw">sapply</span>(power_values, <span class="cf">function</span>(x) x<span class="op">$</span>se))
  
  <span class="co"># Plot</span>
  grids_out[[i]] &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>grid, <span class="dt">y=</span>power)) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">ymin=</span>power <span class="op">-</span><span class="st"> </span>se, <span class="dt">ymax=</span>power <span class="op">+</span><span class="st"> </span>se)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="dt">name =</span> <span class="kw">strsplit</span>(grids_in_name, <span class="st">"_"</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">name =</span> <span class="st">"Power"</span>)
  
}

<span class="co"># Plot</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">grid.arrange</a></span>(grids_out[[<span class="dv">1</span>]], grids_out[[<span class="dv">2</span>]],
             grids_out[[<span class="dv">3</span>]], grids_out[[<span class="dv">4</span>]], 
             <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">nrow=</span><span class="dv">2</span>)</code></pre></div>
<div class="figure">
<img src="assignment3_files/figure-html/unnamed-chunk-2-1.png" alt="Change in statistical power when all parameters are held constant except the one on the x-axis for each plot" width="700"><p class="caption">
Change in statistical power when all parameters are held constant except the one on the x-axis for each plot
</p>
</div>
<p>If we compare the results from the empirical test to the R function, we observe:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power.t.test</span>(<span class="dt">n=</span><span class="dv">50</span>, <span class="dt">delta=</span><span class="dv">10</span>, <span class="dt">sd=</span><span class="dv">15</span>, <span class="dt">type=</span><span class="st">"two.sample"</span>, 
             <span class="dt">sig.level =</span> <span class="fl">0.05</span>, <span class="dt">alternative=</span><span class="st">"one.sided"</span>)</code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 50
##           delta = 10
##              sd = 15
##       sig.level = 0.05
##           power = 0.952077
##     alternative = one.sided
## 
## NOTE: n is number in *each* group</code></pre>
<p>and</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">700</span>)
emp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/emp_power.html">emp_power</a></span>(<span class="dt">n=</span><span class="dv">50</span>, <span class="dt">mu=</span><span class="dv">160</span>, <span class="dt">mu0=</span><span class="dv">150</span>, <span class="dt">sd=</span><span class="dv">15</span>, 
                 <span class="dt">alpha=</span><span class="fl">0.05</span>, <span class="dt">type=</span><span class="st">"two_sample"</span>,
                 <span class="dt">alternative=</span><span class="st">"greater"</span>, <span class="dt">R=</span><span class="dv">1000</span>)
emp<span class="op">$</span>power</code></pre></div>
<pre><code>## [1] 0.954</code></pre>
<p>This gives us a comparable power estimation.</p>
</div>
<div id="part-ii" class="section level2">
<h2 class="hasAnchor">
<a href="#part-ii" class="anchor"></a>PART II</h2>
<p>View the code belonging to this assignment <a href="https://github.com/JasperHG90/meerkat/blob/master/R/a3_perm.R">here</a></p>
<ol style="list-style-type: decimal">
<li><strong>Choose an appropriate resampling technique and make a function that performs a hypothesis test based on the t-statistic produced by the standard t-test function. Use the in-built sample() function to perform the resampling of the data. Include relevant statistics in your function and give the function a clear structure (choose sensible input arguments, organize the output in an efficient way, add comments, etc). Show the results of your resampling technique on the Flight instruction data.</strong></li>
</ol>
<p>We begin by specifying the data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create variables for flight simulation data</span>
CSFI &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)
TFI &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">8</span>)</code></pre></div>
<p>If we assume that the variances are equal, we can apply a two-sample t-test using the permutation method.<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run</span>
<span class="kw">set.seed</span>(<span class="dv">1200</span>)
pt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/permutation_test.html">permutation_test</a></span>(CSFI, TFI, <span class="dv">999</span>)
pt</code></pre></div>
<pre><code>## Two-tailed permutation test using 18 observations and 999 permutations
## 
## K    R   t       p
## -----------------------------------
## 18   999 1.68    0.132</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pt)</code></pre></div>
<p><img src="assignment3_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(CSFI, TFI, <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  CSFI and TFI
## t = 1.6805, df = 16, p-value = 0.1123
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.4967883  4.2967883
## sample estimates:
## mean of x mean of y 
##       6.0       4.1</code></pre>
<p>The results lead to the same conclusion, although the p-value obtained using the permutation test is 15% higher.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>How would you program the drawing of random samples when you do not want to use the sample() function? Modify the function you have programmed in (1) in such a way that it does not use the sample() function anymore. Run your new function and show that you can obtain the same results as in (1).</strong></li>
</ol>
<p>We can use the R function <code>runif()</code> to draw values from the uniform distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
<span class="co"># This draws 5 values from a uniform with a=0 and b=1</span>
<span class="kw">runif</span>(<span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] 0.30776611 0.25767250 0.55232243 0.05638315 0.46854928</code></pre>
<p>If we wanted <span class="math inline">\(80\)</span>% of our rows randomly sampled, then we subset the probabilities generated by the uniform distribution such that they are below <span class="math inline">\(0.8\)</span>. This works because, we know that, if a random variable <span class="math inline">\(X\)</span> has a uniform density with <span class="math inline">\(a, b \in \mathbb{R} \implies P\left[X &lt; a + P(b - a)\right] = P\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Sample from the density from 0 to 1</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(gridExtra)
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>x, <span class="dt">dens=</span><span class="kw">dunif</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">dist=</span><span class="kw">punif</span>(x,<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">rand =</span> <span class="kw">runif</span>(<span class="kw">length</span>(x), <span class="dv">0</span>, <span class="dv">1</span>))
p1 &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>x, <span class="dt">y=</span>dens)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"uniform density"</span>)
p2 &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>x, <span class="dt">y=</span>dist)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"uniform distribution"</span>)
p3 &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>x, <span class="dt">y=</span>rand)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"random uniform distribution values"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="fl">0.25</span>, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="fl">0.5</span>, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="fl">0.75</span>, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">linetype =</span> <span class="dv">3</span>)
<span class="kw"><a href="http://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">grid.arrange</a></span>(p1, p2,p3, <span class="dt">ncol=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="assignment3_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>In the third plot above, we see that approximately 50% of the data lies below the median and 50% lies above it. Hence, if we wanted to sample 80% of our data, we would expect that proportion to be correct <em>on average</em> due to the randomness of the draws.</p>
<p>In the <code><a href="../reference/permutation_test.html">permutation_test()</a></code> function, we can specify whether we want to sample this way using the <code>use_sample()</code> flag. As shown above, there is always a chance that we will draw a sample that is few in number of observations. To make sure that this does not happen, we impose the rule that the proportion of observations may not be above or below one standard error away from the proportion. If this happens, then the function calls itself recursively until the proportion is within acceptable bounds. The bounds may be increased or decreased using the <code>tolerance</code> parameter; the smaller this parameter is, the more we compress the ‘acceptable’ region around the proportion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">888</span>)
pt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/permutation_test.html">permutation_test</a></span>(CSFI, TFI, <span class="dv">999</span>, <span class="dt">use_sample =</span> <span class="ot">FALSE</span>, <span class="dt">tolerance =</span> <span class="dv">1</span>)
pt</code></pre></div>
<pre><code>## Two-tailed permutation test using 18 observations and 999 permutations
## 
## K    R   t       p
## -----------------------------------
## 18   999 1.68    0.142</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">888</span>)
pt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/permutation_test.html">permutation_test</a></span>(CSFI, TFI, <span class="dv">999</span>, <span class="dt">use_sample =</span> <span class="ot">FALSE</span>, <span class="dt">tolerance =</span> <span class="fl">0.5</span>)
pt</code></pre></div>
<pre><code>## Two-tailed permutation test using 18 observations and 999 permutations
## 
## K    R   t       p
## -----------------------------------
## 18   999 1.68    0.15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">888</span>)
pt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/permutation_test.html">permutation_test</a></span>(CSFI, TFI, <span class="dv">999</span>, <span class="dt">use_sample =</span> <span class="ot">TRUE</span>)
pt</code></pre></div>
<pre><code>## Two-tailed permutation test using 18 observations and 999 permutations
## 
## K    R   t       p
## -----------------------------------
## 18   999 1.68    0.148</code></pre>
<p>We may observe different results using these different sampling procedures. This is because the group sizes may vary quite a bit. Moreover, by decreasing the tolerance value, we are resampling many more times because we are discarding many samples. I am not entirely sure how this works with the <code>set.seed()</code> function, but testing shows that the results can vary quite a bit. Clearly, this is quite a roundabout way of trying to get rid of the <code>sample()</code> function.</p>
<p>Another approach to sampling without using the <code>sample()</code> function is to draw values from the binomial distribution.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Which resampling technique(s) would you use, if you would be interested in estimation instead of hypothesis testing? Make an R function that performs resampling for estimation purposes using the mean difference between two groups from the t-test function. Your function should produce all relevant aspects of estimation, and you should discuss these aspects and put them in perspective. Again use the Flight instruction data to show the results of your function.</strong></li>
</ol>
<p>View the code belonging to this assignment <a href="https://github.com/JasperHG90/meerkat/blob/master/R/a3_bootstrap.R">here</a></p>
<p>I would use bootstrapping to do this. Using bootstrapping, we can draw <span class="math inline">\(R\)</span> samples with replacement from the original sample to construct an empirical sampling distribution. In this case, the quantity <span class="math inline">\(\theta\)</span> of interest is the t-statistic.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">4500</span>)
res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/boot_ttest.html">boot_ttest</a></span>(CSFI, TFI, <span class="dt">R=</span><span class="dv">2000</span>)
res</code></pre></div>
<pre><code>## 2000 bootstrapped two-tailed t-statistic values
## 
## Bootstrap statistics :
##  original    bias        std.error   jack-after-boot
##  1.68        0.22        1.22        0.42
## 
## Percentile bootstrap values :
##  alpha       lower       upper
##  0.05        -0.13       4.57</code></pre>
<p>The <code><a href="../reference/boot_ttest.html">boot_ttest()</a></code> function returns a variety of statistics:</p>
<ol style="list-style-type: decimal">
<li>The ‘original’ t-statistic is the value we get when we calculate the t-statistic for the input values.</li>
<li>The <strong>bias</strong> indicates that, on average, we are over-estimating the t-statistic. This we can also observe from the histogram below, which is skewed to the right.</li>
<li>The standard error is the bootstrap estimate of the sampling distribution standard error. We assess its variability using the jackknife-after-bootstrap estimate (‘jack-after-boot’). We observe that that the variability is rather high.</li>
<li>The simple percentile bootstrap values (indicated with green dotted lines in the plot below) contain <span class="math inline">\(0\)</span>, which strengthens the conclusion we reached earlier when we failed to reject <span class="math inline">\(H_0\)</span>. The confidence intervals are close to the confidence intervals to those of the theoretical confidence intervals.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(CSFI, TFI, <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  CSFI and TFI
## t = 1.6805, df = 16, p-value = 0.1123
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.4967883  4.2967883
## sample estimates:
## mean of x mean of y 
##       6.0       4.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(res)</code></pre></div>
<div class="figure">
<img src="assignment3_files/figure-html/unnamed-chunk-16-1.png" alt="Bootstrap distribution of replicates. The red vertical line represents the original t-statistic. The green lines indicate the values of the confidence intervals." width="700"><p class="caption">
Bootstrap distribution of replicates. The red vertical line represents the original t-statistic. The green lines indicate the values of the confidence intervals.
</p>
</div>
<p>In summary, the above diagnostics show that there is a lot of uncertainty in our point estimate. This is not surprising, given that our sample size is very small.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Rizzo, Maria L. “Statistical Computing with R”. Chapman and Hall/CRC, 2007<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Rizzo, p.218<a href="#fnref2">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#part-i">PART I</a></li>
      <li><a href="#part-ii">PART II</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jasper Ginn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
