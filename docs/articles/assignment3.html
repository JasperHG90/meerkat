<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assignment 3 • meerkat</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Assignment 3">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">meerkat</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/assignment2.html">Assignment 2</a>
    </li>
    <li>
      <a href="../articles/assignment3.html">Assignment 3</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JasperHG90/meerkat.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Assignment 3</h1>
                        <h4 class="author">Jasper Ginn</h4>
            
            <h4 class="date">2018-12-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JasperHG90/meerkat.git/blob/master/vignettes/assignment3.Rmd"><code>vignettes/assignment3.Rmd</code></a></small>
      <div class="hidden name"><code>assignment3.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The code in this package is stored in the ‘meerkat’ package. It contains helper functions that are not exported and for which no visible documentation was written. At the start of each part, I give a link to the R-code hosted on GitHub where you can view the code.</p>
</div>
<div id="part-i" class="section level2">
<h2 class="hasAnchor">
<a href="#part-i" class="anchor"></a>PART I</h2>
<p><em>1. Assuming that the data are approximately normal, simulate one sample of data and perform a t-test using the R in-built t-test function. What is the p-value of the test? What is your conclusion?.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="kw">library</span>(meerkat)

<span class="co"># Set values and draw a sample</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mu &lt;-<span class="st"> </span><span class="dv">160</span>
sd &lt;-<span class="st"> </span><span class="dv">15</span>
<span class="kw">set.seed</span>(<span class="dv">600</span>)
exp &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, mu, sd)
<span class="co"># We perform a t-test on the data</span>
<span class="kw">t.test</span>(exp, <span class="dt">alternative=</span><span class="st">"greater"</span>, <span class="dt">mu =</span> <span class="dv">150</span>)</code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  exp
## t = 5.0672, df = 49, p-value = 3.07e-06
## alternative hypothesis: true mean is greater than 150
## 95 percent confidence interval:
##  157.1167      Inf
## sample estimates:
## mean of x 
##  160.6356</code></pre>
<p>The one-tailed test is statistically significant (p&lt;0.0001). At a significance level of a=0.05 we would therefore reject the null that there is no difference in the test scores of these groups. The experimental group , it would seem, performed better than the control and the special training has had the desired effect.</p>
<p><strong>2. Assume that the data are normally distributed, write a function that generates data and performs a t-test 1000 times and that stores the values of the t-statistic (or the p-value) in a vector. Thinking about the definition of power in terms of rejecting the null hypothesis, how would you obtain an estimate of the power in this situation? Compare your results with those given by power.t.test</strong></p>
<p><em>Power</em> is defined as the probability <span class="math inline">\(\pi(\theta)\)</span> of rejecting the null hypothesis given that the alternative hypothesis is true.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. The probability of making a Type II error (wrongfully concluding that there is no effect while an effect exists) is <span class="math inline">\(1-\pi(\theta))\)</span>. A common maximum value for the Type II error is that we should not commit it in more than 20% of cases. Hence, the ‘minimum’ power we should strive for is <span class="math inline">\(0.8\)</span>, meaning that we can detect effects <span class="math inline">\(4\)</span> out of <span class="math inline">\(5\)</span> times.</p>
<p>The function <code><a href="../reference/emp_power.html">emp_power()</a></code> calculates, for a given <span class="math inline">\(R\)</span> number of repititions, the t-statistic between the mean value of the control group and that of a random sample drawn from the normal distribution. Given that we are interested in the probability <span class="math inline">\(\pi(\theta)\)</span>, one reasonable approach is to take the proportion of cases where the null hypothesis is rejected and the p-value of the t-test is lower than the significance level <span class="math inline">\(\alpha\)</span>.</p>
<p>Given that we draw data from a normal distribution and for values where <span class="math inline">\(\theta_0 &lt; \theta_1\)</span>, we may be confident that the power of our test increases as we:</p>
<ol style="list-style-type: decimal">
<li>increase the sample size</li>
<li>increase the significance level <span class="math inline">\(\alpha\)</span> (e.g. from <span class="math inline">\(0.05\)</span> to <span class="math inline">\(0.1\)</span>)</li>
<li>decrease the standard deviation in the sample</li>
</ol>
<p>The effect of changing these values is shown in the plots below</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(grid)
<span class="kw">library</span>(gridExtra)
<span class="co"># Define a grid of possible mean values from 140 to 160</span>
grids &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">grid_mu =</span> <span class="kw">seq</span>(<span class="dv">140</span>, <span class="dv">160</span>, <span class="dv">1</span>),
  <span class="dt">grid_sd =</span> <span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="fl">0.5</span>),
  <span class="dt">grid_alpha =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.11</span>, <span class="fl">0.005</span>),
  <span class="dt">grid_n =</span> <span class="kw">seq</span>(<span class="dv">50</span>, <span class="dv">150</span>, <span class="dv">5</span>)
)

grids_out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>, <span class="dt">length =</span> <span class="dv">4</span>)
<span class="co"># For each value, calculate the power od the t-test while holding the other parameters constant</span>
<span class="cf">for</span>( i <span class="cf">in</span> <span class="kw">seq_along</span>(grids) ) {
  
  <span class="co"># Get name</span>
  grids_in_name &lt;-<span class="st"> </span><span class="kw">names</span>(grids)[i]
  grid &lt;-<span class="st"> </span>grids[[i]]
  
  <span class="co"># This switch is a wrapper for a bunch of if/else statements</span>
  power_values &lt;-<span class="st"> </span><span class="cf">switch</span>(grids_in_name,
         <span class="dt">grid_mu =</span> <span class="kw">lapply</span>(grid, <span class="cf">function</span>(x) <span class="kw"><a href="../reference/emp_power.html">emp_power</a></span>(<span class="dv">150</span>, <span class="dv">50</span>, x, <span class="dv">15</span>, 
                                                      <span class="dt">alpha=</span><span class="fl">0.05</span>, <span class="dt">alternative=</span><span class="st">"greater"</span>)),
         <span class="dt">grid_n =</span> <span class="kw">lapply</span>(grid, <span class="cf">function</span>(x) <span class="kw"><a href="../reference/emp_power.html">emp_power</a></span>(<span class="dv">150</span>, x, <span class="dv">155</span>, <span class="dv">15</span>, 
                                                     <span class="dt">alpha=</span><span class="fl">0.05</span>, <span class="dt">alternative=</span><span class="st">"greater"</span>)),
         <span class="dt">grid_sd =</span> <span class="kw">lapply</span>(grid, <span class="cf">function</span>(x) <span class="kw"><a href="../reference/emp_power.html">emp_power</a></span>(<span class="dv">150</span>, <span class="dv">50</span>, <span class="dv">155</span>, x, 
                                                      <span class="dt">alpha=</span><span class="fl">0.05</span>, <span class="dt">alternative=</span><span class="st">"greater"</span>)),
         <span class="dt">grid_alpha =</span> <span class="kw">lapply</span>(grid, <span class="cf">function</span>(x) <span class="kw"><a href="../reference/emp_power.html">emp_power</a></span>(<span class="dv">150</span>, <span class="dv">50</span>, <span class="dv">155</span>, <span class="dv">15</span>, 
                                                         <span class="dt">alpha=</span>x, <span class="dt">alternative=</span><span class="st">"greater"</span>))
  )
  
  <span class="co"># Get values</span>
  pv &lt;-<span class="st"> </span><span class="kw">sapply</span>(power_values, <span class="cf">function</span>(x) x<span class="op">$</span>power)
  
  <span class="co"># In data frame</span>
  df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">"grid"</span> =<span class="st"> </span>grid,
                   <span class="st">"power"</span> =<span class="st"> </span>pv)
  
  <span class="co"># Plot</span>
  grids_out[[i]] &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(df, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>grid, <span class="dt">y=</span>power)) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="dt">name =</span> <span class="kw">strsplit</span>(grids_in_name, <span class="st">"_"</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">name =</span> <span class="st">"Power"</span>)
  
}

<span class="co"># Plot</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">grid.arrange</a></span>(grids_out[[<span class="dv">1</span>]], grids_out[[<span class="dv">2</span>]],
             grids_out[[<span class="dv">3</span>]], grids_out[[<span class="dv">4</span>]], <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">nrow=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="assignment3_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>If we compare the results from the empirical test to the R function, we observe:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power.t.test</span>(<span class="dt">n=</span><span class="dv">50</span>, <span class="dt">delta=</span><span class="dv">10</span>, <span class="dt">sd=</span><span class="dv">15</span>, <span class="dt">sig.level =</span> <span class="fl">0.05</span>, <span class="dt">alternative=</span><span class="st">"one.sided"</span>)</code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 50
##           delta = 10
##              sd = 15
##       sig.level = 0.05
##           power = 0.952077
##     alternative = one.sided
## 
## NOTE: n is number in *each* group</code></pre>
<p>and</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">emp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/emp_power.html">emp_power</a></span>(<span class="dt">ref_mu=</span><span class="dv">150</span>, <span class="dt">n=</span><span class="dv">50</span>, <span class="dt">mu=</span><span class="dv">160</span>, <span class="dt">sd=</span><span class="dv">15</span>, <span class="dt">alternative=</span><span class="st">"greater"</span>, <span class="dt">R=</span><span class="dv">1000</span>)
emp<span class="op">$</span>power</code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>The empirical power calculation is less conservative than the theoretical implementation. Both display a high degree of power given the parameters.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Rizzo, Maria L. “Statistical Computing with R”. Chapman and Hall/CRC, 2007<a href="#fnref1">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#part-i">PART I</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jasper Ginn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
